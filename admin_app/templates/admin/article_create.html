{% extends 'admin/base.html' %}

{% block title %}Create Article â€” Admin Panel{% endblock %}

{% block head %}
{{ super() }}
<!-- Editor.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@editorjs/image@latest"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/@editorjs/paragraph@latest"></script> PARAGRAPH IS DEFAULT -->
<style>
    /* Optional: Add some basic styling for the editor container */
    .codex-editor__redactor {
        padding-bottom: 100px !important; /* Add space at the bottom */
    }
    .ce-block__content, .ce-toolbar__content {
        max-width: unset; /* Remove max-width restriction */
    }
</style>
{% endblock %}

{% block content %}
<h1>Create New Article</h1>
{% if error %}
    <div class="flash">{{ error }}</div>
{% endif %}
{# Add id to the form for JS targeting #}
<form method="post" action="/admin/articles/create" id="article-form">
    <div style="margin-bottom: 1rem;">
        <label for="title">Title:</label><br>
        <input type="text" id="title" name="title" required style="width: 100%; padding: 0.5rem;">
    </div>
    <div style="margin-bottom: 1rem;">
        <label for="slug">Slug:</label><br>
        <input type="text" id="slug" name="slug" required style="width: 100%; padding: 0.5rem;">
    </div>
    <div style="margin-bottom: 1rem;">
        <label for="editor">Content (Markdown):</label><br>
        {# Replace textarea with a div for Milkdown #}
        <div id="editor" style="border: 1px solid #ccc; border-radius: 5px; min-height: 300px; background-color: #fff;"></div>
        {# Hidden input to store the final Markdown content #}
        <input type="hidden" id="content_md_hidden" name="content_md">
        {# Pass initial markdown content here if needed (e.g., for editing) #}
        {# Example for editing: <textarea id="initial_markdown" style="display: none;">{{ article.content_md | e }}</textarea> #}
        {# For create form, we can skip this or pass an empty string #}
    </div>
    <div style="margin-bottom: 1rem;">
        <label for="status">Status:</label><br>
        <select id="status" name="status" style="width: 100%; padding: 0.5rem;">
            <option value="draft">Draft</option>
            <option value="published">Published</option>
        </select>
    </div>
    <button type="submit" class="btn">Create Article</button>
</form>
{# Note: The actual editor initialization happens in the JS bundle loaded via vite_tags in base.html #}
{% endblock %}