# План Задач по Реализации

Этот файл содержит список задач для разработки статического генератора сайта с админкой.

## Этап 1: Настройка Инфраструктуры и Окружения

*   [x] Создать базовую структуру директорий проекта (`admin_app`, `generator`, `infrastructure`, `static_output`).
*   [x] Написать `docker-compose.yml` для запуска:
    *   [x] MongoDB
    *   [x] MinIO (с настройкой бакета для изображений, например `images`)
    *   [x] Admin App (FastAPI/Uvicorn) - пока можно просто базовый образ Python
    *   [x] Caddy
*   [x] Написать базовый `Caddyfile` с настройками для:
    *   [x] Раздачи статики из `static_output` (с авто-HTTPS, если указан домен)
    *   [x] Проксирования `/admin` на Admin App
    *   [x] Проксирования `/images` на MinIO
*   [x] Создать файл `.env.example` с необходимыми переменными окружения (MONGO_URI, MINIO_ACCESS_KEY, MINIO_SECRET_KEY, MINIO_ENDPOINT_URL, MINIO_BUCKET_NAME, CADDY_DOMAIN_NAME).
*   [x] Настроить базовые `requirements.txt` для `admin_app` и `generator`.
*   [ ] Проверить запуск всех сервисов через `docker-compose up`.

## Этап 2: Разработка Админки (Admin App - FastAPI)

*   [x] Настроить подключение к MongoDB (используя `motor` или `pymongo`).  
    _Выполнено 14.04.2025: асинхронное подключение через motor, централизовано в main.py._
*   [x] Определить Pydantic модели для статей (`ArticleCreate`, `ArticleRead`, `ArticleUpdate`, `ArticleInDB`).  
    _Выполнено 14.04.2025: admin_app/models.py, с документацией._
*   [x] Реализовать CRUD операции для статей (`/admin/articles`):  
    _Выполнено 14.04.2025: admin_app/routes/articles.py, тесты — testing/test_articles_crud.py._
    *   [x] POST `/admin/articles`: Создание новой статьи (статус по умолчанию `draft`).
    *   [x] GET `/admin/articles`: Получение списка статей (с пагинацией).
    *   [x] GET `/admin/articles/{article_id}`: Получение конкретной статьи.
    *   [x] PUT `/admin/articles/{article_id}`: Обновление статьи (включая изменение статуса).
    *   [x] DELETE `/admin/articles/{article_id}`: Удаление статьи.
*   [ ] Настроить подключение к MinIO (используя `boto3`).
*   [ ] Реализовать эндпоинт для загрузки изображений (`/admin/images`):
    *   [ ] POST `/admin/images`: Принимает файл, загружает в MinIO, возвращает URL изображения (через Nginx proxy).
*   [ ] Добавить базовую аутентификацию/авторизацию для админки (например, HTTP Basic Auth или JWT).
*   [ ] (Опционально) Реализовать версионирование статей при обновлении.
*   [ ] Добавить логгирование.

## Этап 3: Разработка Генератора Статики (Generator)

*   [ ] Настроить подключение к MongoDB.
*   [ ] Настроить Jinja2 для работы с шаблонами в `generator/templates/`.
*   [ ] Создать базовые шаблоны (`base.html`, `article.html`).
*   [ ] Реализовать основную логику в `generate.py`:
    *   [ ] Получение всех статей со статусом `published` из MongoDB.
    *   [ ] Очистка директории `static_output` перед генерацией.
    *   [ ] Для каждой статьи:
        *   [ ] Преобразование `content_md` в HTML с помощью `markdown-it-py`.
        *   [ ] Рендеринг HTML с использованием Jinja2 шаблона (`article.html`).
        *   [ ] Сохранение результата в `static_output/{slug}/index.html`.
    *   [ ] (Опционально) Генерация индексной страницы со списком статей.
    *   [ ] (Опционально) Копирование статических ассетов (CSS, JS) в `static_output`.
*   [ ] Добавить логгирование в скрипт генерации.

## Этап 4: Тестирование и Доработка

*   [ ] Протестировать полный цикл: создание статьи -> загрузка картинки -> публикация -> запуск генератора -> проверка статического сайта и доступности картинки.
*   [ ] Настроить CORS в FastAPI, если админка будет SPA.
*   [ ] Добавить обработку ошибок и валидацию во все компоненты.
*   [ ] Проверить корректность работы Caddy proxy для всех location.
*   [ ] Написать/дополнить документацию в `README.md`.

## Этап 5: Развертывание (Deployment)

*   [ ] Подготовить инструкции по развертыванию на сервере.
*   [ ] Настроить CI/CD (опционально).
*   [ ] Настроить бэкапы MongoDB и MinIO.
